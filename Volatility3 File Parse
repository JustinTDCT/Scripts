
#!/bin/bash

if [ $# -eq 0 ]; then
  echo "No arguments provided."
elif [ $# -gt 1 ]; then
  echo "Too many arguments provided."
else
  clear
  echo "Checking if file $1 exists ..."
  if [ -f $1 ]; then
    echo "- file found."
    echo "- (1/13) parsing out command line entries - cmdline.txt ...                               "
    vol -f $1 windows.cmdline > cmdline.txt
    echo "- (2/13) parsing out process tree - pstree.txt ...                                        "
    vol -f $1 windows.pstree > pstree.txt
    echo "- (3/13) parsing out process list - pslist.txt ...                                        "
    vol -f $1 windows.pslist > pslist.txt
    echo "- (4/13) parsing out command lists - cmdlist.txt ...                                      "
    vol -f $1 windows.cmdline > cmdline.txt
    echo "- (5/13) parsing out consoles - consoles.txt ...                                          "
    vol -f $1 windows.consoles > consoles.txt
    echo "- (6/13) parsing out DLL list - dlllist.txt ...                                           "
    vol -f $1 windows.dlllist > dlllist.txt
    echo "- (7/13) looking for potential maleware - malfind.txt ...                                 "
    vol -f $1 windows.malfind > malfind.txt
    echo "- (8/13) parsing out MBR - mbrscan.txt ...                                                "
    vol -f $1 windows.mbrscan > mbrscan.txt
    echo "- (9/13) performing netscan - netscan.txt ...                                             "
    vol -f $1 windows.netscan > netscan.txt
    echo "- (10/13) performing netstat - netstat.txt ...                                            "
    vol -f $1 windows.netstat > netstat.txt
    echo "- (11/13) running process ID scan - psscan.txt ...                                        "
    vol -f $1 windows.psscan > psscan.txt
    echo "- (12/13) getting sessions list - sessions.txt ...                                        "
    vol -f $1 windows.sessions > sessions.txt
    echo "- (13/13) listing susicious threads - suspicous_threads.txt ...                           "
    vol -f $1 windows.suspicious_threads > suspicious_threads.txt
    echo "Done.                                                                                     "
  else
    echo "- file not found!"
  fi
fi
